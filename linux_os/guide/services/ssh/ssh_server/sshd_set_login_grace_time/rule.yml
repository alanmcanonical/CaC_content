documentation_complete: true

title: 'Set SSH LoginGraceTime limit'

description: |-
    The LoginGraceTime parameter specifies the time allowed for successful authentication to
    the SSH server. The longer the Grace period is the more open unauthenticated connections
    can exist. Like other session controls in this session the Grace Period should be limited to
    appropriate organizational limits to ensure the service is available for needed access.

    To set LoginGraceTime edit <tt>/etc/ssh/sshd_config</tt> as follows:
    <pre>LoginGraceTime {{{ xccdf_value("var_sshd_login_grace_time") }}}</pre>

    Note: Local site policy may be more restrictive.

rationale: |-
    Setting the LoginGraceTime parameter to a low number will minimize the risk of successful
    brute force attacks to the SSH server. It will also limit the number of concurrent
    unauthenticated connections While the recommended setting is 60 seconds (1 Minute), set
    the number based on site policy.

severity: medium

references:
  cis@ubuntu2004: 5.2.16

ocil_clause: "LoginGraceTime is not configured or not configured correctly"

ocil: |-
    Run the following command to see what the login grace time is:
    <pre>$ sudo grep LoginGraceTime /etc/ssh/sshd_config</pre>
    If properly configured, the output should be:
    <pre>LoginGraceTime {{{ xccdf_value("var_sshd_login_grace_time") }}}</pre>
