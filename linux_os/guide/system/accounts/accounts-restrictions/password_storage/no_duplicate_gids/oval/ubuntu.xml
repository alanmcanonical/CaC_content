<def-group>
  <definition class="compliance" id="{{{ rule_id }}}" version="1">
    {{{ oval_metadata("Although the groupadd program will not let you create a duplicate Group ID (GID), it is possible for an administrator to manually edit the /etc/group file and change the GID field.") }}}
    <criteria>
      <criterion test_ref="tst_no_duplicate_gids_exist_in_etc_group" comment="no duplicate GIDs exist" />
    </criteria>
  </definition>
  <ind:textfilecontent54_object id="obj_gids_in_etc_group" version="1">
    <ind:filepath datatype="string">/etc/group</ind:filepath>
    <ind:pattern operation="pattern match" datatype="string">^.+?:[^:]*:([^:]+):.*$</ind:pattern>
    <ind:instance operation="greater than or equal" datatype="int">1</ind:instance>
  </ind:textfilecontent54_object>
  <ind:variable_object id="obj_num_duplicate_gids_in_etc_group" version="1">
    <ind:var_ref>var_num_duplicate_gids</ind:var_ref>
  </ind:variable_object>
  <ind:variable_state id="ste_no_duplicate_gids_in_etc_group" version="1">
    <ind:value datatype="int" operation="equals">0</ind:value>
  </ind:variable_state>
  <ind:variable_test check="all" id="tst_no_duplicate_gids_exist_in_etc_group" version="1" comment="no duplicate GIDs exist">
    <ind:object object_ref="obj_num_duplicate_gids_in_etc_group" />
    <ind:state state_ref="ste_no_duplicate_gids_in_etc_group" />
  </ind:variable_test>
  <local_variable datatype="int" id="var_gids_in_etc_group" version="1" comment="all GIDs in the /etc/group">
    <object_component item_field="subexpression" object_ref="obj_gids_in_etc_group" />
  </local_variable>
  <local_variable datatype="int" id="var_number_unique_gids_in_etc_group" version="1" comment="number of unique GIDs in /etc/group">
    <count>
      <unique>
        <variable_component var_ref="var_gids_in_etc_group" />
      </unique>
    </count>
  </local_variable>
  <local_variable datatype="int" id="var_total_number_gids_in_etc_group" version="1" comment="total number of GIDs in /etc/group">
    <count>
        <variable_component var_ref="var_gids_in_etc_group" />
    </count>
  </local_variable>
  <local_variable datatype="int" id="var_num_duplicate_gids" version="1" comment="number of duplicate GIDs">
    <arithmetic arithmetic_operation="add">
      <arithmetic arithmetic_operation="multiply">
        <literal_component datatype="int">-1</literal_component>
        <variable_component var_ref="var_number_unique_gids_in_etc_group" />
      </arithmetic>
      <variable_component var_ref="var_total_number_gids_in_etc_group" />
    </arithmetic>
  </local_variable>
</def-group>
