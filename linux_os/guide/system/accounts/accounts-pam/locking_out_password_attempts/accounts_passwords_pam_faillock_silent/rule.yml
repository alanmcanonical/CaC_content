documentation_complete: true

prodtype: ol8,rhel8,rhel9,ubuntu2004

title: 'Do Not Show System Messages When Unsuccessful Logon Attempts Occur'

description: |-
    This rule ensures the system prevents informative messages from being presented to the user
    pertaining to logon information after a number of incorrect login attempts using
    <tt>pam_faillock.so</tt>.

    pam_faillock.so module requires multiple entries in pam files. These entries must be carefully
    defined to work as expected. In order to avoid errors when manually editing these files, it is
    recommended to use the appropriate tools, such as <tt>authselect</tt> or <tt>authconfig</tt>,
    depending on the OS version.

rationale: |-
   The pam_faillock module without the silent option will leak information about the existence or
   non-existence of a user account in the system because the failures are not recorded for unknown
   users. The message about the user account being locked is never displayed for non-existing user
   accounts allowing the adversary to infer that a particular account exists or not on the system.

severity: medium

identifiers:
    cce@rhel8: CCE-87096-4
    cce@rhel9: CCE-87097-2

references:
    disa: CCI-002238,CCI-000044
    srg: SRG-OS-000329-GPOS-00128,SRG-OS-000021-GPOS-00005
    stigid@ol8: OL08-00-020019
    stigid@rhel8: RHEL-08-020018,RHEL-08-020019
    stigid@ubuntu2004: UBTU-20-010072

ocil_clause: 'the system shows messages when three unsuccessful logon attempts occur'

ocil: |-
    To ensure that the system prevents messages from being shown when three unsuccessful logon
    attempts occur, run the following command:
    <pre>$ grep silent /etc/security/faillock.conf</pre>
    The output should show <tt>silent</tt>.
