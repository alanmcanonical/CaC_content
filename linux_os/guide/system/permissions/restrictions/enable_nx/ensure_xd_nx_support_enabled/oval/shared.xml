<def-group>
  <definition class="compliance" id="ensure_xd_nx_support_enabled" version="1">
    {{{ oval_metadata("Enabling any feature that can protect against buffer overflow attacks enhances the security of the system.") }}}
    <criteria operator="AND">
      <criterion test_ref="test_proc_cmdline_parameter_not_exist" comment="/proc/cmdline parameter must not exist" />
      <criterion test_ref="test_proc_cpuinfo_must_have_pae_or_nx" comment="/proc/cpuinfo must have pae or nx flag" />
      <criterion test_ref="test_var_log_dmesg_must_show_nx_active" comment="/var/log/dmesg must not have string other than active for NX" />
    </criteria>
  </definition>
  <ind:textfilecontent54_test check="all" check_existence="none_exist" id="test_proc_cmdline_parameter_not_exist" version="1" comment="/proc/cmdline parameter must not exist">
    <ind:object object_ref="obj_proc_cmdline_noexec" />
  </ind:textfilecontent54_test>
  <ind:textfilecontent54_test check="all" id="test_proc_cpuinfo_must_have_pae_or_nx" version="1" comment="/proc/cpuinfo must have pae or nx flag">
    <ind:object object_ref="obj_proc_cpuinfo_pae_nx" />
  </ind:textfilecontent54_test>
  <ind:textfilecontent54_test check="all" check_existence="none_exist" id="test_var_log_dmesg_must_show_nx_active" version="1" comment="/var/log/dmesg must not have string other than active for NX">
    <ind:object object_ref="obj_var_log_dmesg_nx_protection" />
  </ind:textfilecontent54_test>
  <ind:textfilecontent54_object id="obj_proc_cmdline_noexec" version="1">
    <ind:filepath datatype="string">/proc/cmdline</ind:filepath>
    <ind:pattern operation="pattern match" datatype="string">\s+noexec[0-9]*=off</ind:pattern>
    <ind:instance datatype="int">1</ind:instance>
  </ind:textfilecontent54_object>
  <ind:textfilecontent54_object id="obj_proc_cpuinfo_pae_nx" version="1">
    <ind:filepath datatype="string">/proc/cpuinfo</ind:filepath>
    <ind:pattern operation="pattern match" datatype="string">\s(pae|nx)\s</ind:pattern>
    <ind:instance datatype="int">1</ind:instance>
  </ind:textfilecontent54_object>
  <ind:textfilecontent54_object id="obj_var_log_dmesg_nx_protection" version="1">
    <ind:filepath datatype="string">/var/log/dmesg</ind:filepath>
    <ind:pattern operation="pattern match" datatype="string">\sNX\s.*\sprotection:\s+(?!active)</ind:pattern>
    <ind:instance datatype="int">1</ind:instance>
  </ind:textfilecontent54_object>
</def-group>
