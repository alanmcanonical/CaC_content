documentation_complete: true

prodtype: sle12,sle15,ubuntu2004,rhel8,fedora

title: 'Configure AIDE to Verify the Audit Tools'

description: |-
    The {{{ full_name }}} operating system file integrity tool must be
    configured to protect the integrity of the audit tools.

rationale: |-
    Protecting the integrity of the tools used for auditing purposes is a
    critical step toward ensuring the integrity of audit information. Audit
    information includes all information (e.g., audit records, audit settings,
    and audit reports) needed to successfully audit information system
    activity.

    Audit tools include but are not limited to vendor-provided and open-source
    audit tools needed to successfully view and manipulate audit information
    system activity and records. Audit tools include custom queries and report
    generators.

    It is not uncommon for attackers to replace the audit tools or inject code
    into the existing tools to provide the capability to hide or erase system
    activity from the audit logs.

    To address this risk, audit tools must be cryptographically signed to
    provide the capability to identify when the audit tools have been modified,
    manipulated, or replaced. An example is a checksum hash of the file or
    files.

severity: medium

identifiers:
    cce@rhel8: CCE-85964-5
    cce@sle12: CCE-83204-8
    cce@sle15: CCE-85610-4

references:
    disa: CCI-001496
    nist: AU-9(3),AU-9(3).1
    srg: SRG-OS-000278-GPOS-00108
    stigid@rhel8: RHEL-08-030650
    stigid@sle12: SLES-12-010540
    stigid@sle15: SLES-15-030630
    stigid@ubuntu2004: UBTU-20-010205

ocil_clause: 'integrity checks of the audit tools are missing or incomplete'

{{% if 'rhel' not in product and 'ubuntu' not in product %}}
{{% set aide_string = 'p+i+n+u+g+s+b+acl+selinux+xattrs+sha512' %}}
{{% else %}}
{{% set aide_string = 'p+i+n+u+g+s+b+acl+xattrs+sha512' %}}
{{% endif %}}

{{% set aide_dir = '/sbin' %}}
{{% if 'ubuntu' not in product %}}
  {{% set aide_dir = '/usr/sbin' %}}
{{% endif %}}


ocil: |-
    Check that AIDE is properly configured to protect the integrity of the
    audit tools by running the following command:

    {{% if 'ubuntu' in product %}}
    <pre>egrep '(\/sbin\/(audit|au))' /etc/aide/aide.conf</pre>
    {{% else %}}
    <pre># sudo cat /etc/aide.conf | grep /usr/sbin/au
    {{% endif %}}

    {{{ aide_dir }}}/auditctl p+i+n+u+g+s+b+acl+xattrs+sha512
    {{{ aide_dir }}}/auditd p+i+n+u+g+s+b+acl+xattrs+sha512
    {{{ aide_dir }}}/ausearch p+i+n+u+g+s+b+acl+xattrs+sha512
    {{{ aide_dir }}}/aureport p+i+n+u+g+s+b+acl+xattrs+sha512
    {{{ aide_dir }}}/autrace p+i+n+u+g+s+b+acl+xattrs+sha512
    {{% if 'rhel' not in product %}}{{{ aide_string }}}/audispd {{{ aide_string }}}{{% endif %}}
    {{{ aide_dir }}}/audispd p+i+n+u+g+s+b+acl+xattrs+sha512
    {{{ aide_dir }}}/augenrules p+i+n+u+g+s+b+acl+xattrs+sha512
    
    If AIDE is configured properly to protect the integrity of the audit tools,
    all lines listed above will be returned from the command.

    If one or more lines are missing, this is a finding.
