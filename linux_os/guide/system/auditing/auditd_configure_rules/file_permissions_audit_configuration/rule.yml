documentation_complete: true

prodtype: ubuntu2004

title: 'Audit Configuration Files Must Have Mode 0640 or Less Permissive'

description: |-
    All audit configuration files must have mode 0640 or less permissive.
    {{{ describe_file_permissions(file="/etc/audit/audit*.{rules,conf}", perms="0640") }}}
    {{{ describe_file_permissions(file="/etc/audit/rules.d/*", perms="0640") }}}

rationale: |-
    Without the capability to restrict which roles and individuals can
    select which events are audited, unauthorized personnel may be able
    to prevent the auditing of critical events.
    Misconfigured audits may degrade the system's performance by
    overwhelming the audit log. Misconfigured audits may also make it more
    difficult to establish, correlate, and investigate the events relating
    to an incident or identify those responsible for one.

severity: medium

references:
    disa: CCI-000171
    srg: SRG-OS-000063-GPOS-00032
    stigid@ubuntu2004: UBTU-20-010133

ocil_clause: |-
    {{{ ocil_clause_file_permissions(file="/etc/audit/audit*.{rules,conf}", perms="-rw-r-----") }}}
    {{{ ocil_clause_file_permissions(file="/etc/audit/rules.d/*", perms="-rw-r-----") }}}

ocil: |-
    {{{ ocil_file_permissions(file="/etc/audit/audit*.{rules,conf}", perms="-rw-r-----") }}}
    {{{ ocil_file_permissions(file="/etc/audit/rules.d/*", perms="-rw-r-----") }}}

template:
    name: file_permissions
    vars:
        filepath:
            - /etc/audit/
            - /etc/audit/rules.d/
        file_regex:
            - ^.*audit.*\.(rules|conf)$
            - ^.*\.rules$
        filemode: '0640'
